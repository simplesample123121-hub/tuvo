"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[314],{1647:(e,r,t)=>{t.d(r,{F$:()=>l,Q5:()=>c,qE:()=>i});var s=t(7437),a=t(2265),n=t(1464),o=t(7440);let i=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(n.fC,{ref:r,className:(0,o.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...a})});i.displayName=n.fC.displayName;let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(n.Ee,{ref:r,className:(0,o.cn)("aspect-square h-full w-full",t),...a})});l.displayName=n.Ee.displayName;let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(n.NY,{ref:r,className:(0,o.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...a})});c.displayName=n.NY.displayName},4693:(e,r,t)=>{t.d(r,{C:()=>i});var s=t(7437);t(2265);var a=t(3027),n=t(7440);let o=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:r,variant:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)(o({variant:t}),r),...a})}},495:(e,r,t)=>{t.d(r,{z:()=>c});var s=t(7437),a=t(2265),n=t(1538),o=t(3027),i=t(7440);let l=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,r)=>{let{className:t,variant:a,size:o,asChild:c=!1,...u}=e,d=c?n.g7:"button";return(0,s.jsx)(d,{className:(0,i.cn)(l({variant:a,size:o,className:t})),ref:r,...u})});c.displayName="Button"},6013:(e,r,t)=>{t.d(r,{Ol:()=>i,SZ:()=>c,Zb:()=>o,aY:()=>u,ll:()=>l});var s=t(7437),a=t(2265),n=t(7440);let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});o.displayName="Card";let i=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...a})});i.displayName="CardHeader";let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("h3",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});l.displayName="CardTitle";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...a})});c.displayName="CardDescription";let u=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...a})});u.displayName="CardContent",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...a})}).displayName="CardFooter"},857:(e,r,t)=>{t.d(r,{AuthProvider:()=>u,a:()=>d});var s=t(7437),a=t(2265),n=t(4904),o=t(8999);let i=new o.KU().setEndpoint("https://nyc.cloud.appwrite.io/v1").setProject("688d133a00190cb1d93c"),l=new o.mR(i),c=(0,a.createContext)(void 0);function u(e){let{children:r}=e,[t,i]=(0,a.useState)(null),[u,d]=(0,a.useState)(!0),m=async()=>{try{let e=await l.get();console.log("Found existing session for:",e.email),await f(e.$id)}catch(e){console.log("No existing session found"),i(null)}finally{d(!1)}};(0,a.useEffect)(()=>((async()=>{try{await g(),await m()}catch(e){console.error("Error initializing app:",e),d(!1)}})(),()=>{}),[]);let f=async e=>{try{let r=await n.UA.listDocuments(n.Vb,n.sh.users,[o.AE.equal("$id",e)]);if(r.documents.length>0)i(r.documents[0]);else{let r=await l.get(),t={email:r.email,name:r.name,role:"user",status:"active",profile:JSON.stringify({})},s=await n.UA.createDocument(n.Vb,n.sh.users,e,t);i(s)}}catch(r){console.error("Error loading user profile:",r),console.log("Using sample user data due to permission/schema issues"),i({$id:e,email:"user@example.com",name:"Sample User",role:"user",status:"active",profile:JSON.stringify({})})}},g=async()=>{try{let e=await n.UA.listDocuments(n.Vb,n.sh.users,[]);if(0===e.documents.length){console.log("No users found, creating default admin...");try{let e=await l.create(o.ID.unique(),"admin@eventbooker.com","Admin@123","System Administrator");console.log("✅ Admin user created in Appwrite auth:",e);let r=e.$id,t={email:"admin@eventbooker.com",name:"System Administrator",role:"admin",status:"active",profile:JSON.stringify({isAdmin:!0,permissions:["events","bookings","users","analytics","settings"],createdBy:"system",isDefaultAdmin:!0})},s=await n.UA.createDocument(n.Vb,n.sh.users,r,t);return console.log("✅ Default admin user created in database:",s),s}catch(e){console.error("Error creating admin in Appwrite auth:",e);try{let e=o.ID.unique(),r={email:"admin@eventbooker.com",name:"System Administrator",role:"admin",status:"active",profile:JSON.stringify({isAdmin:!0,permissions:["events","bookings","users","analytics","settings"],createdBy:"system",isDefaultAdmin:!0})},t=await n.UA.createDocument(n.Vb,n.sh.users,e,r);return console.log("✅ Default admin profile created:",t),t}catch(e){console.error("Error creating admin profile:",e)}}}}catch(e){console.error("Error creating default admin:",e)}},p=async(e,r)=>{try{try{let e=await l.get();return console.log("User already logged in:",e.email),await f(e.$id),{success:!0,message:"Already logged in"}}catch(e){console.log("No active session, proceeding with login")}await l.createEmailSession(e,r);let t=await l.get();return await f(t.$id),{success:!0,message:"Login successful"}}catch(e){return console.error("Login error:",e),{success:!1,message:e.message||"Login failed"}}},y=async()=>{try{await l.deleteSession("current"),i(null),d(!1)}catch(e){console.error("Logout error:",e),i(null),d(!1)}},h=async(e,r,t)=>{try{let s=await l.create(o.ID.unique(),r,t,e);try{await l.updateVerification(s.$id,s.$id)}catch(e){console.log("Auto-verification failed (this is normal in production):",e)}await f(s.$id);try{await l.createEmailSession(r,t);let e=await l.get();await f(e.$id)}catch(e){console.log("Auto-login after registration failed:",e)}return{success:!0,message:"Registration successful! Please check your email to verify your account."}}catch(e){return console.error("Registration error:",e),{success:!1,message:e.message||"Registration failed"}}},w=async e=>{if(!t)return{success:!1,message:"User not authenticated"};try{let r={name:e.name,email:e.email,role:e.role,status:e.status};e.profile&&(r.profile="string"==typeof e.profile?e.profile:JSON.stringify(e.profile));let s=await n.UA.updateDocument(n.Vb,n.sh.users,t.$id,r);return i(s),{success:!0,message:"Profile updated successfully"}}catch(e){return console.error("Profile update error:",e),{success:!1,message:e.message||"Failed to update profile"}}},v=async(e,r)=>{try{return await l.updatePassword(r),{success:!0,message:"Password changed successfully"}}catch(e){return console.error("Password change error:",e),{success:!1,message:e.message||"Failed to change password"}}},b=async e=>{try{return await l.createRecovery(e,"http://localhost:3000/reset-password"),{success:!0,message:"Password reset email sent"}}catch(e){return console.error("Forgot password error:",e),{success:!1,message:e.message||"Failed to send reset email"}}},x=async(e,r,t)=>{try{return await l.updateRecovery(e,r,t,t),{success:!0,message:"Password reset successfully"}}catch(e){return console.error("Reset password error:",e),{success:!1,message:e.message||"Failed to reset password"}}},N=async()=>{try{let e=await l.get();await f(e.$id)}catch(e){console.error("Error refreshing user:",e),i(null)}},A={user:t,loading:u,isAuthenticated:!!t,isAdmin:(null==t?void 0:t.role)==="admin"||(null==t?void 0:t.role)==="super_admin",isSuperAdmin:(null==t?void 0:t.role)==="super_admin",login:p,logout:y,register:h,loadUserProfile:f,updateProfile:w,changePassword:v,forgotPassword:b,resetPassword:x,refreshUser:N,parseProfile:e=>{try{return JSON.parse(e)}catch(e){return console.error("Failed to parse profile string:",e),null}}};return(0,s.jsx)(c.Provider,{value:A,children:r})}let d=()=>{let e=(0,a.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},4904:(e,r,t)=>{t.d(r,{JT:()=>o,UA:()=>n,Vb:()=>i,sh:()=>l});var s=t(8999);let a=new s.KU().setEndpoint("https://nyc.cloud.appwrite.io/v1").setProject("688d133a00190cb1d93c"),n=new s.Lg(a),o=new s.mR(a);new s.Ke(a);let i="eventbooker_db",l={events:"events",bookings:"bookings",users:"users",settings:"settings",analytics:"analytics"}},7440:(e,r,t)=>{t.d(r,{Dm:()=>d,Ld:()=>u,T4:()=>o,aY:()=>c,cn:()=>n,mr:()=>l,p6:()=>i});var s=t(4839),a=t(6164);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.m6)((0,s.W)(r))}function o(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}function i(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}function l(e){return new Date("2000-01-01T".concat(e)).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}function c(e,r){let t=new Date("".concat(e,"T").concat(r)),s=new Date,a=new Date(t.getTime()+108e5);return s>=t&&s<=a}function u(e,r){let t=new Date("".concat(e,"T").concat(r));return new Date<t}let d=e=>{if(!e)return"";try{let r=JSON.parse(e);return(null==r?void 0:r.avatar)||""}catch(e){return console.error("Failed to parse profile for avatar:",e),""}}}}]);