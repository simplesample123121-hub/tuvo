(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[674],{4318:(e,s,t)=>{Promise.resolve().then(t.bind(t,2573))},2573:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>k});var a=t(7437),r=t(2265),l=t(495),n=t(6013),i=t(3102),d=t(7135),c=t(6294),o=t(4693),u=t(1647),m=t(2022),x=t(500),h=t(957),f=t(2513),p=t(4817),j=t(7164),v=t(5733),y=t(7529),g=t(883),N=t(857),b=t(4904),w=t(8999);function k(){let{user:e,isSuperAdmin:s}=(0,N.a)(),[t,k]=(0,r.useState)([]),[S,Z]=(0,r.useState)(!0),[_,C]=(0,r.useState)(""),[E,A]=(0,r.useState)("all"),[z,R]=(0,r.useState)("all"),[L,M]=(0,r.useState)(null),[V,D]=(0,r.useState)(!1),[U,Q]=(0,r.useState)(!1);(0,r.useEffect)(()=>{I()},[]);let I=async()=>{try{Z(!0);let e=(await b.UA.listDocuments(b.Vb,b.sh.users)).documents,s=await Promise.all(e.map(async e=>{try{var s;let t=(await b.UA.listDocuments(b.Vb,b.sh.bookings,[w.AE.equal("user_id",e.$id)])).documents,a=t.filter(e=>"completed"===e.payment_status).reduce((e,s)=>e+s.payment_amount,0),r=t.length>0?null===(s=t.sort((e,s)=>new Date(s.created_at).getTime()-new Date(e.created_at).getTime())[0])||void 0===s?void 0:s.created_at:void 0;return{...e,bookingCount:t.length,totalSpent:a,lastBooking:r}}catch(s){return{...e,bookingCount:0,totalSpent:0}}}));k(s)}catch(e){console.error("Error loading users:",e)}finally{Z(!1)}},O=t.filter(e=>{let s=e.name.toLowerCase().includes(_.toLowerCase())||e.email.toLowerCase().includes(_.toLowerCase()),t="all"===E||e.role===E,a="all"===z||e.status===z;return s&&t&&a}),P=async e=>{if(!s){alert("Only super admins can delete users");return}if(confirm("Are you sure you want to delete this user? This action cannot be undone."))try{await b.UA.deleteDocument(b.Vb,b.sh.users,e),await I()}catch(e){console.error("Error deleting user:",e)}},B=e=>{let s={user:{color:"bg-blue-100 text-blue-800",icon:m.Z},admin:{color:"bg-purple-100 text-purple-800",icon:x.Z},super_admin:{color:"bg-yellow-100 text-yellow-800",icon:h.Z}},t=s[e]||s.user,r=t.icon;return(0,a.jsxs)(o.C,{className:t.color,children:[(0,a.jsx)(r,{className:"h-3 w-3 mr-1"}),e.replace("_"," ").toUpperCase()]})},T=e=>{let s={active:{color:"bg-green-100 text-green-800",text:"Active"},inactive:{color:"bg-gray-100 text-gray-800",text:"Inactive"},suspended:{color:"bg-red-100 text-red-800",text:"Suspended"}},t=s[e]||s.inactive;return(0,a.jsx)(o.C,{className:t.color,children:t.text})};return S?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),(0,a.jsx)("p",{className:"mt-2",children:"Loading users..."})]})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"User Management"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage user accounts, roles, and permissions"})]}),(0,a.jsxs)(l.z,{onClick:()=>Q(!0),children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Add User"]})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)(n.ll,{children:"Filters"})}),(0,a.jsx)(n.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{children:"Search"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(p.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(i.I,{placeholder:"Search users...",value:_,onChange:e=>C(e.target.value),className:"pl-10"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{children:"Role"}),(0,a.jsxs)(c.Ph,{value:E,onValueChange:A,children:[(0,a.jsx)(c.i4,{children:(0,a.jsx)(c.ki,{placeholder:"All Roles"})}),(0,a.jsxs)(c.Bw,{children:[(0,a.jsx)(c.Ql,{value:"all",children:"All Roles"}),(0,a.jsx)(c.Ql,{value:"user",children:"User"}),(0,a.jsx)(c.Ql,{value:"admin",children:"Admin"}),(0,a.jsx)(c.Ql,{value:"super_admin",children:"Super Admin"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{children:"Status"}),(0,a.jsxs)(c.Ph,{value:z,onValueChange:R,children:[(0,a.jsx)(c.i4,{children:(0,a.jsx)(c.ki,{placeholder:"All Status"})}),(0,a.jsxs)(c.Bw,{children:[(0,a.jsx)(c.Ql,{value:"all",children:"All Status"}),(0,a.jsx)(c.Ql,{value:"active",children:"Active"}),(0,a.jsx)(c.Ql,{value:"inactive",children:"Inactive"}),(0,a.jsx)(c.Ql,{value:"suspended",children:"Suspended"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{children:"Actions"}),(0,a.jsxs)(l.z,{variant:"outline",className:"w-full",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"Export"]})]})]})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{children:(0,a.jsxs)(n.ll,{children:["Users (",O.length,")"]})}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:O.map(e=>{var t;return(0,a.jsx)("div",{className:"border rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)(u.qE,{children:[(0,a.jsx)(u.F$,{src:""}),(0,a.jsx)(u.Q5,{children:null===(t=e.name)||void 0===t?void 0:t.charAt(0).toUpperCase()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.email}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[B(e.role),T(e.status)]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-sm font-medium",children:[e.bookingCount," bookings"]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["$",e.totalSpent.toFixed(2)," spent"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>{M(e),D(!0)},children:(0,a.jsx)(v.Z,{className:"h-4 w-4"})}),(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>{M(e),Q(!0)},children:(0,a.jsx)(y.Z,{className:"h-4 w-4"})}),s&&"super_admin"!==e.role&&(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>P(e.$id),children:(0,a.jsx)(g.Z,{className:"h-4 w-4"})})]})]})]})},e.$id)})})})]}),V&&L&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"User Details"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(d._,{children:"Name"}),(0,a.jsx)("p",{className:"text-sm",children:L.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d._,{children:"Email"}),(0,a.jsx)("p",{className:"text-sm",children:L.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d._,{children:"Role"}),(0,a.jsx)("div",{className:"mt-1",children:B(L.role)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d._,{children:"Status"}),(0,a.jsx)("div",{className:"mt-1",children:T(L.status)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d._,{children:"Bookings"}),(0,a.jsxs)("p",{className:"text-sm",children:[L.bookingCount," total bookings"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d._,{children:"Total Spent"}),(0,a.jsxs)("p",{className:"text-sm",children:["$",L.totalSpent.toFixed(2)]})]}),L.lastBooking&&(0,a.jsxs)("div",{children:[(0,a.jsx)(d._,{children:"Last Booking"}),(0,a.jsx)("p",{className:"text-sm",children:new Date(L.lastBooking).toLocaleDateString()})]})]}),(0,a.jsx)("div",{className:"flex justify-end space-x-2 mt-6",children:(0,a.jsx)(l.z,{variant:"outline",onClick:()=>D(!1),children:"Close"})})]})})]})}},3102:(e,s,t)=>{"use strict";t.d(s,{I:()=>n});var a=t(7437),r=t(2265),l=t(7440);let n=r.forwardRef((e,s)=>{let{className:t,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n})});n.displayName="Input"},7135:(e,s,t)=>{"use strict";t.d(s,{_:()=>c});var a=t(7437),r=t(2265),l=t(8364),n=t(3027),i=t(7440);let d=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.f,{ref:s,className:(0,i.cn)(d(),t),...r})});c.displayName=l.f.displayName},6294:(e,s,t)=>{"use strict";t.d(s,{Bw:()=>f,Ph:()=>o,Ql:()=>p,i4:()=>m,ki:()=>u});var a=t(7437),r=t(2265),l=t(8297),n=t(2421),i=t(4392),d=t(2468),c=t(7440);let o=l.fC;l.ZA;let u=l.B4,m=r.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsxs)(l.xz,{ref:s,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...i,children:[r,(0,a.jsx)(l.JO,{asChild:!0,children:(0,a.jsx)(n.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=l.xz.displayName;let x=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.u_,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})});x.displayName=l.u_.displayName;let h=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.$G,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(n.Z,{className:"h-4 w-4"})})});h.displayName=l.$G.displayName;let f=r.forwardRef((e,s)=>{let{className:t,children:r,position:n="popper",...i}=e;return(0,a.jsx)(l.h_,{children:(0,a.jsxs)(l.VY,{ref:s,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...i,children:[(0,a.jsx)(x,{}),(0,a.jsx)(l.l_,{className:(0,c.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(h,{})]})})});f.displayName=l.VY.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.__,{ref:s,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r})}).displayName=l.__.displayName;let p=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(l.ck,{ref:s,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(l.wU,{children:(0,a.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(l.eT,{children:r})]})});p.displayName=l.ck.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.Z0,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=l.Z0.displayName},957:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(1066).Z)("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]])},7164:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(1066).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},5733:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(1066).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},7529:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(1066).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},2513:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(1066).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},4817:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(1066).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},500:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(1066).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},883:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(1066).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},2022:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(1066).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},6246:(e,s,t)=>{"use strict";var a=t(2265),r="function"==typeof Object.is?Object.is:function(e,s){return e===s&&(0!==e||1/e==1/s)||e!=e&&s!=s},l=a.useState,n=a.useEffect,i=a.useLayoutEffect,d=a.useDebugValue;function c(e){var s=e.getSnapshot;e=e.value;try{var t=s();return!r(e,t)}catch(e){return!0}}var o="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,s){return s()}:function(e,s){var t=s(),a=l({inst:{value:t,getSnapshot:s}}),r=a[0].inst,o=a[1];return i(function(){r.value=t,r.getSnapshot=s,c(r)&&o({inst:r})},[e,t,s]),n(function(){return c(r)&&o({inst:r}),e(function(){c(r)&&o({inst:r})})},[e]),d(t),t};s.useSyncExternalStore=void 0!==a.useSyncExternalStore?a.useSyncExternalStore:o},554:(e,s,t)=>{"use strict";e.exports=t(6246)},1464:(e,s,t)=>{"use strict";t.d(s,{NY:()=>k,Ee:()=>w,fC:()=>b});var a=t(2265),r=t(8324),l=t(5137),n=t(1336),i=t(5171),d=t(554);function c(){return()=>{}}var o=t(7437),u="Avatar",[m,x]=(0,r.b)(u),[h,f]=m(u),p=a.forwardRef((e,s)=>{let{__scopeAvatar:t,...r}=e,[l,n]=a.useState("idle");return(0,o.jsx)(h,{scope:t,imageLoadingStatus:l,onImageLoadingStatusChange:n,children:(0,o.jsx)(i.WV.span,{...r,ref:s})})});p.displayName=u;var j="AvatarImage",v=a.forwardRef((e,s)=>{let{__scopeAvatar:t,src:r,onLoadingStatusChange:u=()=>{},...m}=e,x=f(j,t),h=function(e,s){let{referrerPolicy:t,crossOrigin:r}=s,l=(0,d.useSyncExternalStore)(c,()=>!0,()=>!1),i=a.useRef(null),o=l?(i.current||(i.current=new window.Image),i.current):null,[u,m]=a.useState(()=>N(o,e));return(0,n.b)(()=>{m(N(o,e))},[o,e]),(0,n.b)(()=>{let e=e=>()=>{m(e)};if(!o)return;let s=e("loaded"),a=e("error");return o.addEventListener("load",s),o.addEventListener("error",a),t&&(o.referrerPolicy=t),"string"==typeof r&&(o.crossOrigin=r),()=>{o.removeEventListener("load",s),o.removeEventListener("error",a)}},[o,r,t]),u}(r,m),p=(0,l.W)(e=>{u(e),x.onImageLoadingStatusChange(e)});return(0,n.b)(()=>{"idle"!==h&&p(h)},[h,p]),"loaded"===h?(0,o.jsx)(i.WV.img,{...m,ref:s,src:r}):null});v.displayName=j;var y="AvatarFallback",g=a.forwardRef((e,s)=>{let{__scopeAvatar:t,delayMs:r,...l}=e,n=f(y,t),[d,c]=a.useState(void 0===r);return a.useEffect(()=>{if(void 0!==r){let e=window.setTimeout(()=>c(!0),r);return()=>window.clearTimeout(e)}},[r]),d&&"loaded"!==n.imageLoadingStatus?(0,o.jsx)(i.WV.span,{...l,ref:s}):null});function N(e,s){return e?s?(e.src!==s&&(e.src=s),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}g.displayName=y;var b=p,w=v,k=g},8364:(e,s,t)=>{"use strict";t.d(s,{f:()=>i});var a=t(2265),r=t(5171),l=t(7437),n=a.forwardRef((e,s)=>(0,l.jsx)(r.WV.label,{...e,ref:s,onMouseDown:s=>{var t;s.target.closest("button, input, select, textarea")||(null===(t=e.onMouseDown)||void 0===t||t.call(e,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));n.displayName="Label";var i=n}},e=>{var s=s=>e(e.s=s);e.O(0,[673,474,432,268,314,130,215,744],()=>s(4318)),_N_E=e.O()}]);