(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{4569:(e,t,r)=>{Promise.resolve().then(r.bind(r,4524)),Promise.resolve().then(r.bind(r,2756)),Promise.resolve().then(r.bind(r,857)),Promise.resolve().then(r.t.bind(r,936,23)),Promise.resolve().then(r.t.bind(r,5214,23))},4524:(e,t,r)=>{"use strict";r.d(t,{ThemeProvider:()=>o});var s=r(7437);r(2265);var a=r(5169);function o(e){let{children:t,...r}=e;return(0,s.jsx)(a.f,{...r,children:t})}},2756:(e,t,r)=>{"use strict";r.d(t,{Toaster:()=>N});var s=r(7437),a=r(2265),o=r(4504),i=r(3027),n=r(4697),c=r(7440);let l=o.zt,u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(o.l_,{ref:t,className:(0,c.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",r),...a})});u.displayName=o.l_.displayName;let d=(0,i.j)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),m=a.forwardRef((e,t)=>{let{className:r,variant:a,...i}=e;return(0,s.jsx)(o.fC,{ref:t,className:(0,c.cn)(d({variant:a}),r),...i})});m.displayName=o.fC.displayName,a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(o.aU,{ref:t,className:(0,c.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",r),...a})}).displayName=o.aU.displayName;let f=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(o.x8,{ref:t,className:(0,c.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",r),"toast-close":"",...a,children:(0,s.jsx)(n.Z,{className:"h-4 w-4"})})});f.displayName=o.x8.displayName;let p=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(o.Dx,{ref:t,className:(0,c.cn)("text-sm font-semibold",r),...a})});p.displayName=o.Dx.displayName;let g=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(o.dk,{ref:t,className:(0,c.cn)("text-sm opacity-90",r),...a})});g.displayName=o.dk.displayName;let h=0,w=new Map,v=e=>{if(w.has(e))return;let t=setTimeout(()=>{w.delete(e),A({type:"REMOVE_TOAST",toastId:e})},1e6);w.set(e,t)},y=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?v(r):e.toasts.forEach(e=>{v(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},x=[],b={toasts:[]};function A(e){b=y(b,e),x.forEach(e=>{e(b)})}function S(e){let{...t}=e,r=(h=(h+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>A({type:"DISMISS_TOAST",toastId:r});return A({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||s()}}}),{id:r,dismiss:s,update:e=>A({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function N(){let{toasts:e}=function(){let[e,t]=a.useState(b);return a.useEffect(()=>(x.push(t),()=>{let e=x.indexOf(t);e>-1&&x.splice(e,1)}),[e]),{...e,toast:S,dismiss:e=>A({type:"DISMISS_TOAST",toastId:e})}}();return(0,s.jsxs)(l,{children:[e.map(function(e){let{id:t,title:r,description:a,action:o,...i}=e;return(0,s.jsxs)(m,{...i,children:[(0,s.jsxs)("div",{className:"grid gap-1",children:[r&&(0,s.jsx)(p,{children:r}),a&&(0,s.jsx)(g,{children:a})]}),o,(0,s.jsx)(f,{})]},t)}),(0,s.jsx)(u,{})]})}},857:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>u,a:()=>d});var s=r(7437),a=r(2265),o=r(4904),i=r(8999);let n=new i.KU().setEndpoint("https://nyc.cloud.appwrite.io/v1").setProject("688d133a00190cb1d93c"),c=new i.mR(n),l=(0,a.createContext)(void 0);function u(e){let{children:t}=e,[r,n]=(0,a.useState)(null),[u,d]=(0,a.useState)(!0),m=async()=>{try{let e=await c.get();console.log("Found existing session for:",e.email),await f(e.$id)}catch(e){console.log("No existing session found"),n(null)}finally{d(!1)}};(0,a.useEffect)(()=>((async()=>{try{await p(),await m()}catch(e){console.error("Error initializing app:",e),d(!1)}})(),()=>{}),[]);let f=async e=>{try{let t=await o.UA.listDocuments(o.Vb,o.sh.users,[i.AE.equal("$id",e)]);if(t.documents.length>0)n(t.documents[0]);else{let t=await c.get(),r={email:t.email,name:t.name,role:"user",status:"active",profile:JSON.stringify({})},s=await o.UA.createDocument(o.Vb,o.sh.users,e,r);n(s)}}catch(e){console.error("Error loading user profile:",e),n(null)}},p=async()=>{try{let e=await o.UA.listDocuments(o.Vb,o.sh.users,[]);if(0===e.documents.length){console.log("No users found, creating default admin...");try{let e=await c.create(i.ID.unique(),"admin@eventbooker.com","Admin@123","System Administrator");console.log("✅ Admin user created in Appwrite auth:",e);let t=e.$id,r={email:"admin@eventbooker.com",name:"System Administrator",role:"admin",status:"active",profile:JSON.stringify({isAdmin:!0,permissions:["events","bookings","users","analytics","settings"],createdBy:"system",isDefaultAdmin:!0})},s=await o.UA.createDocument(o.Vb,o.sh.users,t,r);return console.log("✅ Default admin user created in database:",s),s}catch(e){console.error("Error creating admin in Appwrite auth:",e);try{let e=i.ID.unique(),t={email:"admin@eventbooker.com",name:"System Administrator",role:"admin",status:"active",profile:JSON.stringify({isAdmin:!0,permissions:["events","bookings","users","analytics","settings"],createdBy:"system",isDefaultAdmin:!0})},r=await o.UA.createDocument(o.Vb,o.sh.users,e,t);return console.log("✅ Default admin profile created:",r),r}catch(e){console.error("Error creating admin profile:",e)}}}}catch(e){console.error("Error creating default admin:",e)}},g=async(e,t)=>{try{try{await c.deleteSession("current")}catch(e){console.log("No active session to delete")}await c.createEmailSession(e,t);let r=await c.get();return await f(r.$id),{success:!0,message:"Login successful"}}catch(e){return console.error("Login error:",e),{success:!1,message:e.message||"Login failed"}}},h=async()=>{try{await c.deleteSession("current"),n(null),d(!1)}catch(e){console.error("Logout error:",e),n(null),d(!1)}},w=async(e,t,r)=>{try{let s=await c.create(i.ID.unique(),t,r,e);try{await c.updateVerification(s.$id,s.$id)}catch(e){console.log("Auto-verification failed (this is normal in production):",e)}await f(s.$id);try{await c.createEmailSession(t,r);let e=await c.get();await f(e.$id)}catch(e){console.log("Auto-login after registration failed:",e)}return{success:!0,message:"Registration successful! Please check your email to verify your account."}}catch(e){return console.error("Registration error:",e),{success:!1,message:e.message||"Registration failed"}}},v=async e=>{if(!r)return{success:!1,message:"User not authenticated"};try{let t={name:e.name,email:e.email,role:e.role,status:e.status};e.profile&&(t.profile="string"==typeof e.profile?e.profile:JSON.stringify(e.profile));let s=await o.UA.updateDocument(o.Vb,o.sh.users,r.$id,t);return n(s),{success:!0,message:"Profile updated successfully"}}catch(e){return console.error("Profile update error:",e),{success:!1,message:e.message||"Failed to update profile"}}},y=async(e,t)=>{try{return await c.updatePassword(t),{success:!0,message:"Password changed successfully"}}catch(e){return console.error("Password change error:",e),{success:!1,message:e.message||"Failed to change password"}}},x=async e=>{try{return await c.createRecovery(e,"http://localhost:3000/reset-password"),{success:!0,message:"Password reset email sent"}}catch(e){return console.error("Forgot password error:",e),{success:!1,message:e.message||"Failed to send reset email"}}},b=async(e,t,r)=>{try{return await c.updateRecovery(e,t,r,r),{success:!0,message:"Password reset successfully"}}catch(e){return console.error("Reset password error:",e),{success:!1,message:e.message||"Failed to reset password"}}},A=async()=>{try{let e=await c.get();await f(e.$id)}catch(e){console.error("Error refreshing user:",e),n(null)}},S={user:r,loading:u,isAuthenticated:!!r,isAdmin:(null==r?void 0:r.role)==="admin"||(null==r?void 0:r.role)==="super_admin",isSuperAdmin:(null==r?void 0:r.role)==="super_admin",login:g,logout:h,register:w,loadUserProfile:f,updateProfile:v,changePassword:y,forgotPassword:x,resetPassword:b,refreshUser:A,parseProfile:e=>{try{return JSON.parse(e)}catch(e){return console.error("Failed to parse profile string:",e),null}}};return(0,s.jsx)(l.Provider,{value:S,children:t})}let d=()=>{let e=(0,a.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},4904:(e,t,r)=>{"use strict";r.d(t,{JT:()=>i,UA:()=>o,Vb:()=>n,sh:()=>c});var s=r(8999);let a=new s.KU().setEndpoint("https://nyc.cloud.appwrite.io/v1").setProject("688d133a00190cb1d93c"),o=new s.Lg(a),i=new s.mR(a);new s.Ke(a);let n="eventbooker_db",c={events:"events",bookings:"bookings",users:"users",settings:"settings",analytics:"analytics"}},7440:(e,t,r)=>{"use strict";r.d(t,{Dm:()=>u,Ld:()=>l,T4:()=>i,_w:()=>p,aY:()=>c,cn:()=>o,p6:()=>n});var s=r(4839),a=r(6164);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,s.W)(t))}function i(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}function n(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}function c(e,t){let r=new Date("".concat(e,"T").concat(t)),s=new Date,a=new Date(r.getTime()+108e5);return s>=r&&s<=a}function l(e,t){let r=new Date("".concat(e,"T").concat(t));return new Date<r}let u=e=>{if(!e)return"";try{let t=JSON.parse(e);return(null==t?void 0:t.avatar)||""}catch(e){return console.error("Failed to parse profile for avatar:",e),""}},d=()=>window.innerWidth<768,m=()=>{let e=window.navigator.userAgent;return/iPad|iPhone|iPod/.test(e)&&/Safari/.test(e)&&!/Chrome/.test(e)},f=()=>{let e=window.navigator.userAgent;return/Android/.test(e)&&/Chrome/.test(e)},p=()=>{console.log("Mobile Debug Info:",{userAgent:window.navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight,devicePixelRatio:window.devicePixelRatio},isMobile:d(),isMobileSafari:m(),isMobileChrome:f()})}},5214:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[6351,9673,8474,2432,5216,7130,6215,1744],()=>t(4569)),_N_E=e.O()}]);